<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">

<!---- DO NOT EDIT: HTML generated by CourseCompiler ---->


<head>
<title>Recipes/Common/Derivative</title>

<meta name="description" content="Recipes/Common/Derivative:  Symbolic differentiation.">

<meta name="keywords" content="Recipes/Common/Derivative, Rascal, meta-programming, software analysis, software transformation">
<link type="text/css" rel="stylesheet" href="/prelude.css"/>
<link type="text/css" rel="stylesheet" href="/jquery.autocomplete.css"/>
<script type="text/javascript" src="/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="/jquery.colorbox-min.js"></script>
<script type="text/javascript" src="/jquery.cookie.js"></script>
<script type="text/javascript" src="/jquery.jstree.js"></script>
<script type="text/javascript" src="/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/jquery.history.js"></script>
<script type="text/javascript" src="/globals.js"></script>
<script type="text/javascript" src="/prelude.js"></script>
<script type="text/javascript" src="/Recipes/course.js"></script>

</head>
<body>
<table id="container"><tr><td id="tdlogo"><a id="tutorAction" href="/index.html"><img id="leftIcon" height="40" width="40" src="/images/rascal-tutor-small.png"></a></td><td id="tdsearch">
<div id="searchBox">
  <form method="GET" id="searchForm" action="/search"> 
    <img id="searchIcon" height="20" width="20" src="/images/magnify.png">
    <input type="hidden" name="concept" value="Recipes/Common/Derivative">
    <input type="text" id="searchField" name="term" autocomplete="off"><br />
    <div id="popups"></div>
  </form>
</div>
</td></tr><tr><td id="tdnav">
<a id="navPanePlaceHolder" href="/Recipes/navigate.html" >Navigation</a>
<script type="text/javascript"> var navigationPaneSource="/Recipes/navigate.html"; </script></td><td id="tdconcept">
<div id="conceptPane">

<div id="Name">
<span class="sectionHead">Name</span> <a href="/Recipes/Recipes.html">Recipes</a>/<a href="/Recipes/Common/Common.html">Common</a>/<a href="/Recipes/Common/Derivative/Derivative.html">Derivative</a>
</div>

<div id="Synopsis">
<span class="sectionHead">Synopsis</span>  Symbolic differentiation.

</div>





<div id="Description">
<span class="sectionHead">Description</span>  Computing the <a href="http://en.wikipedia.org/wiki/Differentiation_(mathematics)">derivative<img src="/images/www-icon.png" with="20" height="20"></a> of an expression with respect to some variable is a classical calculus problem. Loosely speaking, a derivative can be thought of as how much one quantity is changing in response to changes in some other quantity; for example, the derivative of the position of a moving object with respect to time is the object's instantaneous velocity.
 <br/>
<br/>

 We present here rules for determining the derivative <code>dE/dX</code> of simple expressions <code>E</code> for a given variable <code>X</code>. Recall that for number <code>N</code>, variables <code>X</code> and <code>Y</code>, and expressions <code>E1</code> and <code>E2</code> the following rules apply:
 <ul><li> <code>dN / dX = 0</code>.</li>
<li> <code>dX / dX = 1</code>.</li>
<li> <code>dX / dY = 0</code>, when <code>X != Y</code>.</li>
<li> <code>d(E1 + E2) /dX = dE1 / dX + d E2 /dX</code>.</li>
<li> <code>d(E1 * E2) / dX =  (d E1 / dX  * E2) + (E1 * d E2 /dX)</code>.</li>
</ul>
</div>


<div id="Examples">
<span class="sectionHead">Examples</span>  Our solution consists of the following parts:
 <ul><li> Define a data type <code>Exp</code> to represent expressions (<img src="/images/1.png">).</li>
<li> Introduce an example expression <code>E</code> for later use (<img src="/images/2.png">).</li>
<li> Define the actual differentiation function <code>dd</code> (<img src="/images/3.png">). Observe that this definition depends on the use of patterns in function declarations, see <a href="/Rascal/Declarations/Function/Function.html">Rascal:Function</a>.</li>
<li> Define simplification rules (<img src="/images/4.png">). Observe that a default rule is give for the case that no simplification applies (<img src="/images/5.png">).</li>
<li> Define the actual simplication function <code>simplify</code> that performs a bottom up traversal of the expression, application simplification rules on the the up.
</li>
</ul> <pre class="listing">module demo::common::Derivative

data Exp = con(int n)           <img src="/images/1.png">
         | var(str name)
         | mul(Exp e1, Exp e2)
         | add(Exp e1, Exp e2)
         ;
         
public Exp E = add(mul(con(3), var("y")), mul(con(5), var("x"))); <img src="/images/2.png">

public Exp dd(con(n), var(V))              = con(0);  <img src="/images/3.png">
public Exp dd(var(V1), var(V2))            = con((V1 == V2) ? 1 : 0);
public Exp dd(add(Exp e1, Exp e2), var(V)) = add(dd(e1, var(V)), dd(e2, var(V)));
public Exp dd(mul(Exp e1, Exp e2), var(V)) = add(mul(dd(e1, var(V)), e2), mul(e1, dd(e2, var(V))));
 

public Exp simp(add(con(n), con(m))) = con(n + m);   <img src="/images/4.png">
public Exp simp(mul(con(n), con(m))) = con(n * m);

public Exp simp(mul(con(1), Exp e))  = e;
public Exp simp(mul(Exp e, con(1)))  = e;
public Exp simp(mul(con(0), Exp e))  = con(0);
public Exp simp(mul(Exp e, con(0)))  = con(0);

public Exp simp(add(con(0), Exp e))  = e;
public Exp simp(add(Exp e, con(0)))  = e;

public default Exp simp(Exp e)       = e;            <img src="/images/5.png">

public Exp simplify(Exp e){                          <img src="/images/6.png">
  return bottom-up visit(e){
           case Exp e1 => simp(e1)
         }
}


</pre> Let's differentiate the example expression <code>E</code>:
 <pre class="screen"><span class="prompt">rascal></span>import demo::common::Derivative;
ok
<span class="prompt">rascal></span>dd(E, var(&quot;x&quot;));
Exp: add(
  add(
    mul(
      con(0),
      var("y")),
    mul(
      con(3),
      con(0))),
  add(
    mul(
      con(0),
      var("x")),
    mul(
      con(5),
      con(1))))
</pre>  As you can see, we managed to compute a derivative, but the result is far more complex than we would like.
  This is where simplification comes in. First try a simple case:
<pre class="screen"><span class="prompt">rascal></span>simplify(mul(var(&quot;x&quot;), add(con(3), con(5))));
Exp: mul(
  var("x"),
  con(8))
</pre>  Now apply simplification to the result of differentiation:
<pre class="screen"><span class="prompt">rascal></span>simplify(dd(E, var(&quot;x&quot;)));
Exp: con(5)
</pre>
</div>




<a id="tutorAction" href="/index.html"><img id="leftIcon" height="40" width="40" src="/images/rascal-tutor-small.png"></a><div id="editMenu">[<a id="editAction" href="/edit?concept=Recipes/Common/Derivative&new=false"><b>Edit</b></a>] | 
               [<a id="newAction" href="/edit?concept=Recipes/Common/Derivative&new=true"><b>New Subconcept</b></a>] |
               [<a id="compileAction" href="/compile?name=Recipes"><b>Recompile Course</b></a>] |
               [<a id="warnAction" href="/Recipes/warnings.html"><b>Warnings</b></a>]</div>
<span class="editMenuFooter">Is this page unclear, or have you spotted an error? Please add a comment below and help us to improve it. For all other questions and remarks, visit <a href="http://ask.rascal-mpl.org">ask.rascal-mpl.org</a>. </span>
</div>
</td></tr></table>
</body>
</html>